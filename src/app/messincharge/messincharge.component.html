<div id="wrapper">
  <!-- begin TOP NAVIGATION -->
  <app-header></app-header>
  <!-- end TOP NAVIGATION -->

  <!-- begin SIDE NAVIGATION -->
  <app-sidemenu [page]="_apiService.page"></app-sidemenu>
  <!-- end SIDE NAVIGATION -->

  <!-- begin MAIN PAGE CONTENT -->
  <div id="page-wrapper">

    <div class="spl-content">
      <div class="row">
        <div class="col-lg-12">
          <div class="page-title">
            <!--<h1>
              Admin <small>Dashboard</small>
            </h1>-->
            <ol class="breadcrumb">
              <li><i class="fa fa-dashboard"></i> <a [routerLink]="['/dashboard']">Dashboard/MaterialManagement</a>
              </li>
              <!--<li class="active">Blank Page</li>-->
            </ol>
          </div>
        </div>
        <!-- /.col-lg-12 -->
      </div>

      <!-- begin PAGE TITLE ROW -->

      <!-- /.row -->
      <!-- end PAGE TITLE ROW -->

      <div class="portlet portlet-default">
        <div class="portlet-heading">
          <div class="portlet-title">
            <h4> Material Management </h4>
          </div>
          <div class="clearfix"></div>
        </div>
        <div class="portlet-body">
          <ul id="myTab" class="nav nav-tabs">
            <li class="active"><a href="#in" data-toggle="tab">Material In</a>
            </li>
            <li class=""><a href="#out" data-toggle="tab">Material Out</a>
            </li>
            <li class=""><a href="#stock" data-toggle="tab">Stock Register</a>
            </li>
            <li class=""><a href="#balance" data-toggle="tab">Stock Balance</a>
            </li>
          </ul>
          <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="in">
              <form (ngSubmit)="itemaddform()" method="post" [formGroup]="itemaddForm">
                <!-- <div formArrayName="activeList" class="form-body"> -->
                <div class="form-horizontal">
                  <div class="form-group">
                    <div class="row">
                      <label class="control-label col-md-1">Date</label>
                      <div class="col-md-2">
                        <my-date-picker locale="en" #start formControlName="insert_date" name="insert_date" placeholder="YYYY-MM-DD" [options]="myDatePickerOptions"
                          (dateChanged)="onDateChanged($event)"></my-date-picker>
                      </div>
                      <button (click)="addnewitem()" type="button" style="margin-left:10px" class="btn btn-blue pull-left btn-square">Add new</button>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="col-md-3">
                      <label>Item</label>
                    </div>
                    <div class="col-md-2">
                      <label>Quantity</label>
                    </div>
                    <div class="col-md-2">
                      <label>Units</label>
                    </div>
                    <div class="col-md-2">
                      <label>Price</label>
                    </div>

                  </div>
                </div>
                <!-- <div formArrayName="activeList" class="form-body"> -->
                <div *ngFor="let numbersActivities of itemaddForm.controls.activeList['controls'];let p=index;" class="">
                  <div [formGroup]="itemaddForm.controls.activeList.controls[p]">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <div class="col-md-3">

                          <select class="form-control" formControlName="name" name="name">
                        <option *ngFor="let it of data1" value="{{it.mid}}">{{it.item}}</option>
                        <!--<option *ngFor="let key of objectKeys(data1)" value="{{it.mid}}">{{key + ' : ' + data1[key]}}</option>-->
                      </select>
                        </div>
                        <div class="col-md-2">

                          <input type="text" class="form-control" name="quantity" value="quantity" formControlName="quantity" />
                        </div>
                        <div class="col-md-2">

                          <select class="form-control" formControlName="units" name="units">
                           <option *ngFor="let it of units" value="{{it.u}}">{{it.u}}</option>
                                        
                          </select>
                        </div>

                        <div class="col-md-2">

                          <input type="text" name="price" class="form-control" value="price" formControlName="price" />
                        </div>

                        <!-- <div class="col-md-2">

                          <input type="text" class="form-control" name="total" value="total" formControlName="total" />
                        </div> -->


                        <div class="col-md-3">

                          <button *ngIf="p > 0 " (click)="removeList(p)" type="button" style="margin-right:10px" class="btn btn-danger pull-right btn-square">Remove</button>

                          <button (click)="addactiveList()" type="button" style="margin-right:10px" class="btn btn-green pull-right btn-square">{{p}}Add More</button>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-2">
                    <button type="submit" [disabled]=!itemaddForm.valid class="btn btn-default btn-square col-md-6" style="margin-top: 25px;">Submit</button>
                  </div>
                </div>
                <!-- </div> -->
              </form>
            </div>

            <div class="tab-pane fade" id="out">
              <form (ngSubmit)="itemoutform()" method="post" [formGroup]="itemoutForm">
                <div class="form-horizontal">
                  <div class="form-group">
                    <div class="row">
                      <label class="control-label col-md-1">Date</label>
                      <div class="col-md-2">
                        <my-date-picker locale="en" formControlName="out_date" name="out_date" placeholder="YYYY-MM-DD" required [options]="myDatePickerOptions"
                          (dateChanged)="onDateChanged2($event)"></my-date-picker>
                      </div>
                      <label class="control-label col-md-1">Slot</label>
                      <div class="col-md-2">
                        <select class="form-control" formControlName="slot" name="slot">
                        <option *ngFor="let user of slots" value="{{user.name}}">{{user.name}}</option>
                      </select>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <div class="col-md-3">
                      <label>Item</label>
                    </div>
                    <div class="col-md-3">
                      <label>Quantity</label>
                    </div>
                    <div class="col-md-3">
                      <label>Units</label>
                    </div>

                  </div>
                </div>

                <div *ngFor="let numbersActivities1 of itemoutForm.controls.activeList1['controls'];let p=index;" class="">
                  <div [formGroup]="itemoutForm.controls.activeList1.controls[p]">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <div class="col-md-3">

                          <select class="form-control" formControlName="name" name="name">
                        <option *ngFor="let it of data1" value="{{it.mid}}">{{it.item}}</option>
                      </select>
                        </div>
                        <div class="col-md-2">

                          <input type="text" class="form-control" name="quantity" value="quantity" formControlName="quantity" />
                        </div>
                        <div class="col-md-2">

                          <select class="form-control" formControlName="units" name="units">
                            <option *ngFor="let it of units" value="{{it.u}}">{{it.u}}</option>                                 
                          </select>
                        </div>
                          <div class="col-md-4">
                            <button *ngIf="p > 0 " (click)="removeList1(addmore_length)" type="button" style="margin-right:10px" class="btn btn-danger btn-square">Remove</button>
                            <button (click)="addactiveList1()" type="button" style="margin-right:90px" class="btn btn-green pull-right btn-square">Add More</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-2">
                      <button type="submit" [disabled]="!itemoutForm.valid" class="btn btn-default btn-square col-md-6" style="margin-top: 25px;">Submit</button>
                      <!-- <button type="submit" [disabled]="!itemaddForm.valid" class="btn btn-default btn-square col-md-6" style="margin-top: 25px;">Submit</button> -->
                    </div>
                  </div>

              </form>

              </div>

              <div class="tab-pane fade" id="stock">
                <div class="portlet portlet-default">
                  <div class="portlet-heading">
                    <div class="portlet-title">
                      <h4>Stock Register</h4>
                    </div>
                    <!-- <div class="portlet-widgets">
                    <a (click)="showAddForm()" style="cursor: pointer !important"><i class="fa fa-plus-square"></i> <span class="divider"></span> Add Issue</a>
                  </div> -->
                    <div class="clearfix"></div>
                  </div>
                  <div *ngIf="stock_data" class="portlet-body">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <div class="col-md-3">
                          <input class="form-control" [(ngModel)]="filterQuery" placeholder="Search" />
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12 tabel_overflow">
                        <!--<table class="table table-green table-bordered table-hover">-->
                        <table class="table table-bordered table-green" [mfData]="stock_data" #mf="mfDataTable" [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy"
                          [(mfSortOrder)]="sortOrder">
                          <thead>
                            <tr>
                              <th>
                                <mfDefaultSorter by="edate">S.NO</mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="insert_dt">Add Date</mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="item_name">Item Name</mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="trans_type">Item Added Type</mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="quantity">Quantity</mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="price">Price</mfDefaultSorter>
                              </th>

                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of mf.data; let i=index;">
                              <td>{{i+1}}</td>
                              <td>{{item.insert_dt}}</td>
                              <td>{{item.item_name}}</td>
                              <td>{{item.trans_type}}</td>
                              <td>{{item.quantity}}</td>
                              <td>{{item.price}}</td>


                            </tr>
                          </tbody>
                          <!--<tbody *ngIf="mf.data.length == 0">
                        <tr rowspan="2">
                          <td colspan="12">
                            <h4 *ngIf="mf.data.length == 0" class="text-center"> No Data found</h4>
                          </td>
                        </tr>
                      </tbody>-->
                          <tfoot>
                            <tr>
                              <td colspan="12">
                                <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                              </td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="tab-pane fade" id="balance">
                <div class="portlet portlet-default">
                  <div class="portlet-heading">
                    <div class="portlet-title">
                      <h4>Stock Balance</h4>
                    </div>

                    <div class="clearfix"></div>
                  </div>
                  <div *ngIf="stock_balance" class="portlet-body">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <div class="col-md-3">
                          <input class="form-control" [(ngModel)]="filterQuery" placeholder="Search" />
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-12 tabel_overflow">

                        <table class="table table-bordered table-green" [mfData]="stock_balance" #mf="mfDataTable" [mfRowsOnPage]="rowsOnPage" [(mfSortBy)]="sortBy"
                          [(mfSortOrder)]="sortOrder">
                          <thead>
                            <tr>
                              <th>
                                <mfDefaultSorter by="">S.NO</mfDefaultSorter>
                              </th>

                              <th>
                                <mfDefaultSorter by="item">Item Name</mfDefaultSorter>
                              </th>


                              <th>
                                <mfDefaultSorter by="total_balance">Balance</mfDefaultSorter>
                              </th>

                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let items of mf.data; let i=index;">
                              <td>{{i+1}}</td>
                              <td>{{items.item}}</td>
                              <td>{{items.total_balance}}</td>
                            </tr>
                          </tbody>

                          <tfoot>
                            <tr>
                              <td colspan="12">
                                <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                              </td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
        <!-- end DASHBOARD CIRCLE TILES -->
      </div>
      <!-- /.page-content -->
    </div>
    <!-- /#page-wrapper -->
    <!-- end MAIN PAGE CONTENT -->
  </div>

  <app-modal #modal1>
    <div class="app-modal-header">
      <h4 style="color:black">
        Add New item <a data-dismiss="modal" class="pull-right" (click)="close()">x</a>
      </h4>
    </div>
    <div class="app-modal-body">

      <label class="col-sm-4 control-label">Item</label>
      <div class="col-sm-4">
        <input type="text" name="item" [(ngModel)]="item" required/>
      </div>

    </div>
    <div class="app-modal-footer" style="margin-top: 10px;">
      <button type="button" class="btn btn-default btn-square" (click)="submit();">Submit</button>
    </div>
  </app-modal>